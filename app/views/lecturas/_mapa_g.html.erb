
<fieldset>
<legend onclick="$(this).next('div').slideToggle()">Mapa</legend>
<div id="map" style="width: 100%; height: 400px;"></div>
</fieldset>


<script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>

<script type="text/javascript">

function init() {
	points_toma = [];
	<%  @lecturas.select{|a| a.lectura_lat.present?}.each do |l| %>
	    points_toma.push([ <%= l.lectura_lat %> , <%= l.lectura_lon %>]);
	<% end %>

	points = [];
	<%  @lecturas.select{|a| a.lat.present?}.each do |l| %>
	    points.push([ <%= l.lat %> , <%= l.lon %>]);
	<% end %>

  var mapOptions = {
    center: new google.maps.LatLng(points[0][0], points[0][1]),
    zoom: 14,
  }
  var map = new google.maps.Map(document.getElementById('map'), mapOptions);

  for(i=0; i < points.length; i++) 
  {
	  marker = new google.maps.Marker({
		  position: new google.maps.LatLng(points[i][0], points[i][1]),
		  map: map,
		  icon: 'http://maps.google.com/mapfiles/ms/icons/red-dot.png',
	      title: 'Hello World!'
	  });
  }			
		
  for(i=0; i < points_toma.length; i++) 
  {
	  marker = new google.maps.Marker({
		  position: new google.maps.LatLng(points[i][0], points[i][1]),
		  map: map,
		  icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
	      title: 'Hello World!'
	  });
  }			
		

}


google.maps.event.addDomListener(window, 'load', init);

</script>

<div onclick="$('#map').toggleClass('.fullscreen');">Full</div>
