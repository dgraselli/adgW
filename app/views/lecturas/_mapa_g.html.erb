
<fieldset>
<legend onclick="$(this).next('div').slideToggle()">Mapa</legend>
<div id="map" class="mapa"></div>
</fieldset>


<script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>

<script type="text/javascript">

function init() {

	points = [];
	<%  @lecturas.select{|a| a.lat.present?}.each do |l| %>
	    points.push([ <%= l.lat %> , <%= l.lon %>]);
	<% end %>

  var mapOptions = {
    center: new google.maps.LatLng(points[0][0], points[0][1]),
    zoom: 14,
  }
  var map = new google.maps.Map(document.getElementById('map'), mapOptions);
		
  <%  @lecturas.select{|a| a.lectura_lat.present?}.each do |l| %>
  	  new google.maps.Marker({
		  position: new google.maps.LatLng( <%= l.lectura_lat %> , <%= l.lectura_lon %> ),
		  map: map,
		  icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
	      title: '<%=l.direccion%>'
	  });
  <% end %>		

  <%  @lecturas.select{|a| a.lat.present?}.each do |l| %>
  	  new google.maps.Marker({
		  position: new google.maps.LatLng( <%= l.lat %> , <%= l.lon %> ),
		  map: map,
		  icon: 'http://maps.google.com/mapfiles/ms/icons/red-dot.png',
	      title: '<%=l.direccion%>'
	  });
  <% end %>		

}


google.maps.event.addDomListener(window, 'load', init);

</script>

<div onclick="$('#map').toggleClass('mapa');$('#map').toggleClass('fullscreen');">Full</div>
